version: 2
jobs:
    build:
        docker:
            - image: jimdo/reportbook
            - image: circleci/mongo
            - image: circleci/mysql
              environment:
                  MYSQL_DATABASE: "reportbook_test"
                  MYSQL_USER: "reportbook-test"
                  MYSQL_PASSWORD: "geheim"
                  MYSQL_ROOT_PASSWORD: "geheim"
        environment:
            DOCKER_HOST_IP: "localhost"

        steps:
            - checkout
            - run: pecl install mongodb
            - run: ./scripts/circleci-setup.sh
            # - run: make bootstrap
            # - run: ./scripts/selenium-setup-circleci.sh
            # - run: ./scripts/run-circleci-reportbook.sh
    # deploy-job:
    #     wonderland:
    #         - branch: master
    #         - run: make deploy

# machine:
#     services:
#         - docker
#         - mysql
#         - mongod
#     php:
#         version: "7.1.3"
#     environment:
#         MONGO_HOST: "127.0.0.1"
#         MYSQL_DATABASE: "reportbook_test"
#         MYSQL_HOST: "127.0.0.1"
#         MYSQL_USER: "reportbook-test"
#         MYSQL_PASSWORD: "geheim"
#         SELENIUM_IP: "127.0.0.1"
# dependencies:
#     override:
#         - pecl install mongodb
#         - ./scripts/circleci-setup.sh
#         - make bootstrap
#         - ./scripts/selenium-setup-circleci.sh
#         - ./scripts/run-circleci-reportbook.sh
# test:
#     override:
#         - ./scripts/run-tests-circleci.sh
# deployment:
#     wonderland:
#         branch: master
#         commands:
#             - make deploy
