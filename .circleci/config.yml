version: 2
jobs:
  build:
    docker:
      - image: circleci/php:7.1
      - image: circleci/mongo:latest
      - image: circleci/mysql:latest
        environment:
          MYSQL_DATABASE: 'reportbook_test'
          MYSQL_USER: 'reportbook-test'
          MYSQL_PASSWORD: 'geheim'
          MYSQL_ALLOW_EMPTY_PASSWORD: true

    # working_directory: /var/www/

    environment:
      DOCKER_HOST_IP: '172.17.0.1'

    steps:
      - checkout
      - setup_remote_docker
      - run:
          name: "Setup Mongo Database"
          command: ./scripts/circleci/setup-mongo-database.sh
      - run:
          name: "Setup Mysql Database"
          command: ./scripts/circleci/setup-mysql-database.sh

workflows:
  version: 2
  build:
    jobs:
      - build
# deploy-job:
#   wonderland:
#     - branch: master
#     - run: make deploy
